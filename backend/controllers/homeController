const fs = require("fs").promises;
const path = require("path");
const { getCoverPhoto, getFolderNames } = require("../helpers/helperFunctions");

exports.getmain = async (req, res) => {
	// Define the paths to the directories
	const coverDirectoryPath =
		"/Users/kevinmcpeak/Projects/Home_Media_App/frontend/public/assets/photos/cover/";
	const picturesDirectoryPath =
		"/Users/kevinmcpeak/Projects/Home_Media_App/frontend/public/assets/photos/pictures/";

	try {
		const coverImageName = await getCoverPhoto(coverDirectoryPath);

		// get folder names (years)
		const folderYearNames = await getFolderNames(picturesDirectoryPath);

		let yearInfo = {
			folderYearNames: folderYearNames.filter(Boolean),
			testString: "this is a string",
		};

		res.render("index", {
			coverImageName,
			yearInfo,
		});
	} catch (err) {
		console.error("Error:", err);
		res.status(500).send(
			"An error occurred while reading the directories."
		);
	}
};
